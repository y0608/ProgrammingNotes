# Файлови системи

![[15.02.2023 - Теория 2023-05-12 10.06.10.excalidraw]]

## Meta info
- тип на fs-> htfs; razerfs; zfs; ext4; ext3; ext2;
- Data Block size -> колко байта минимум ще изхабим за файл
- inode table -> таблица от inode-ове (тук се съхраняват всички файлове)
*Въпрос: какво точно представлява таблицата? масив?*

## Inode
inode - структура от данни, която еднозначно описва файл

От гледна точка на ОС всички файлове са inode-ове

характеристика:
- Meta info
	- owner & group -> всеки файл се асоциира с точно един user и точно една група
	- permissions(права)
	- atime - access - последен момент inode-a е достъпен 
	- mtime - modified - последно съдържанието е променено
	- ctime - change - последно съдържанието или meta info е променено
- size - колко B (байта) има
- link count - бройката препратки към този файл
- content table

Използва се UNIX time -> времето се брои в секунди, изминали от 01.01.1970 
<sup>бонус: Y2K; ISO 8601</sup> 

*Въпрос: size определя колко байта е целият файл? големината на content table + meta info?*

### Content table
Това е самият файл

![[15.02.2023 - Теория 2023-05-12 10.37.55.excalidraw]]
Всички елементи са номера на datablock-ове от DB table
- В един DB може да има инфо **само** за един файл
- Номерата на DB не е нужно да са последователни
- Един номер на DB се записва в 4 байта ^cd143d


##### Първите 10 елемента 
Номера на DB, чиито байтове интерпретираме като съдържанието на файла (тук db size е много важен за performance)

пример:
![[15.02.2023 - Теория 2023-05-12 11.10.36.excalidraw|500]]


##### 11тият елемент - 0RDB(Zero Reference Data Block)
Номер на DB, чиито байтове интерпретираме като номера на други DB, чиито байтове интерпретираме като съдържанието на файла.

![[15.02.2023 - Теория 2023-05-12 11.21.59.excalidraw]]


##### 12тият елемент - 1RDB
Едно ниво нагоре от 11тия. Номер на DB, чиито байтове интерпретираме като номера на други DB, чиито байтове интерпретираме като номера на други DB, чиито байтове интерпретираме като съдържанието на файла.

![[15.02.2023 - Теория 2023-05-12 11.37.42.excalidraw]]


##### 13тият елемент - 2RDB
Едно ниво нагоре от 12тия. Номер на DB, чиито байтове интерпретираме като номера на други DB, чиито байтове интерпретираме като номера на други DB, чиито байтове интерпретираме като номера на други DB, чиито байтове интерпретираме като съдържанието на файла.

![[15.02.2023 - Теория 2023-05-12 11.38.47.excalidraw]]

Общо:
`10*512 + 128*512 + 128*128*512 + 128*128*128*512 = 4 TB`
512 -> size

512/4 = 128 -> брой на елементите
![[2023.02.15 - Теория#^cd143d]]



# Права за достъп

## За файлове:
- r -> read
- w -> write
- e -> execute

## Репрезентация

#### Символна
| owner | group | other |
| :----:| :----:| :----:|
|  rwx  |  rwx  |  rwx  |
|  ---  |  ---  |  ---  |

пример: `rw-|r-x|---`

|     owner      |      group       |  other  |
|:--------------:|:----------------:|:-------:|
|      rw-       |       r-x        |   ---   |
| read and write | read and execute | nothing |



#### Числова
|     | R   | W   | X   | binary |
| --- | --- | --- | --- | ------ |
| 7   | r   | w   | x   | 111    |
| 6   | r   | w   | -   | 110    |
| 5   | r   | -   | x   | 101    | 
| 4   | r   | -   | -   | 100    |
| 3   | -   | w   | x   | 011    |
| 2   | -   | w   | -   | 010    |
| 1   | -   | -   | x   | 001    |
| 0   | -   | -   | -   | 000    |

пример:
136

|   1   |   3   |   6   |
|:-----:|:-----:|:-----:|
| owner | group | other | 
|  --x  |  -wx  |  rw-  |